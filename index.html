<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard de Calidad - Demo</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* ===== Reset y tipograf칤a ===== */
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; }
    body { background: #f5f7fa; color: #333; }
    button { cursor: pointer; }

    /* ===== Header ===== */
    header { background: #fff; padding: 20px 30px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); border-radius: 12px; margin: 20px auto; max-width: 1200px; }
    header h1 { font-size: 28px; color: #1f1f1f; }

    /* ===== Login ===== */
    #loginSection { max-width: 400px; margin: 80px auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    #loginSection h2 { margin-bottom: 20px; text-align: center; color: #1f1f1f; }
    .form-group { margin-bottom: 15px; display: flex; flex-direction: column; }
    .form-group label { margin-bottom: 5px; font-weight: 500; }
    .form-group input { padding: 10px 12px; border-radius: 8px; border: 1px solid #ccc; }
    .btn { padding: 12px; border: none; border-radius: 8px; background: #21808d; color: #fff; font-weight: 500; transition: background 0.2s; }
    .btn:hover { background: #1d747f; }
    .error-msg { color: #ff4d4f; text-align: center; margin-bottom: 10px; }

    /* ===== Contenedor principal ===== */
    #app { display: none; max-width: 1200px; margin: 20px auto; padding: 0 20px; }
    .buttons { margin-bottom: 20px; display: flex; gap: 12px; flex-wrap: wrap; }
    .buttons button { background: #21808d; color: #fff; border-radius: 8px; padding: 10px 15px; border: none; font-weight: 500; }
    .buttons button.hidden { display: none; }

    /* ===== Tabla ===== */
    .table-container { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); overflow-x: auto; margin-bottom: 30px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; font-size: 14px; }
    th { background: #f0f3f7; font-weight: 600; position: sticky; top: 0; }
    .badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; color: #fff; font-weight: 500; }
    .badge-success { background: #32b8c6; }
    .badge-error { background: #ff5459; }

    /* ===== Ranking ===== */
    #rankingSection { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-bottom: 30px; }

    /* ===== Gr치ficos ===== */
    .charts-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .chart-container { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }

    /* ===== Fecha y hora ===== */
    #dateTime { margin-bottom: 20px; font-size: 16px; font-weight: 500; }

    /* ===== Oculto ===== */
    .hidden { display: none; }
  </style>
</head>
<body>

  <!-- ===== Login ===== -->
  <div id="loginSection">
    <h2>Login</h2>
    <div class="error-msg" id="loginError"></div>
    <div class="form-group">
      <label>Usuario</label>
      <input type="text" id="username">
    </div>
    <div class="form-group">
      <label>Contrase침a</label>
      <input type="password" id="password">
    </div>
    <button class="btn" onclick="login()">Ingresar</button>
  </div>

  <!-- ===== Aplicaci칩n ===== -->
  <div id="app">
    <header>
      <h1>游늵 Dashboard de Calidad</h1>
      <div id="dateTime"></div>
    </header>

    <div class="buttons">
      <button id="btnDashboard">Dashboard</button>
      <button id="btnRanking">Ranking</button>
      <button id="btnGestionCalidad">Gesti칩n Calidad</button>
    </div>

    <!-- ===== Tabla ===== -->
    <div id="tableSection" class="table-container">
      <input type="text" id="searchInput" placeholder="游댌 Buscar..." style="margin-bottom: 10px; padding: 8px; border-radius: 6px; border: 1px solid #ccc; width: 100%; max-width: 300px;">
      <table>
        <thead id="tableHead"></thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>

    <!-- ===== Ranking ===== -->
    <div id="rankingSection" class="hidden">
      <h3>游끥 Ranking por Habilidad Comercial</h3>
      <table>
        <thead>
          <tr>
            <th>Ejecutivo</th>
            <th>Habilidad Comercial</th>
          </tr>
        </thead>
        <tbody id="rankingBody"></tbody>
      </table>
    </div>

    <!-- ===== Gr치ficos ===== -->
    <div class="charts-grid">
      <div class="chart-container"><canvas id="chart1"></canvas></div>
      <div class="chart-container"><canvas id="chart2"></canvas></div>
    </div>

  </div>

  <script>
    // ===== Usuarios de prueba =====
    const users = {
      calidad: { password: 'dejahair', role: 'calidad' },
      operaciones: { password: 'Operaciones2026', role: 'operaciones' }
    };

    // ===== Datos de prueba =====
    const sampleData = [
      { Ejecutivo: 'Juan Perez', 'Habilidad Comercial': 'SI', 'Tipo de Llamada': 'Venta' },
      { Ejecutivo: 'Maria Gomez', 'Habilidad Comercial': 'NO', 'Tipo de Llamada': 'No Venta' },
      { Ejecutivo: 'Luis Torres', 'Habilidad Comercial': 'SI', 'Tipo de Llamada': 'Venta' },
      { Ejecutivo: 'Ana Ruiz', 'Habilidad Comercial': 'SI', 'Tipo de Llamada': 'No Venta' },
      { Ejecutivo: 'Carlos Diaz', 'Habilidad Comercial': 'NO', 'Tipo de Llamada': 'Venta' },
    ];

    let currentUser = null;

    // ===== Login =====
    function login() {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      const errorDiv = document.getElementById('loginError');

      if (users[username] && users[username].password === password) {
        currentUser = users[username];
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('app').style.display = 'block';
        setupUIByRole(currentUser.role);
        renderTable(sampleData);
        renderRanking(sampleData);
        renderCharts(sampleData);
        startDateTime();
      } else {
        errorDiv.textContent = 'Usuario o contrase침a incorrectos';
      }
    }

    // ===== Mostrar botones seg칰n rol =====
    function setupUIByRole(role) {
      if (role === 'calidad') {
        document.getElementById('btnDashboard').classList.add('hidden');
        document.getElementById('btnRanking').classList.add('hidden');
        document.getElementById('btnGestionCalidad').classList.remove('hidden');
      } else if (role === 'operaciones') {
        document.getElementById('btnDashboard').classList.remove('hidden');
        document.getElementById('btnRanking').classList.remove('hidden');
        document.getElementById('btnGestionCalidad').classList.add('hidden');
      }
    }

    // ===== Tabla =====
    function renderTable(data) {
      const tableHead = document.getElementById('tableHead');
      const tableBody = document.getElementById('tableBody');
      const headers = ['Ejecutivo', 'Habilidad Comercial', 'Tipo de Llamada'];
      tableHead.innerHTML = '<tr>' + headers.map(h => '<th>' + h + '</th>').join('') + '</tr>';
      tableBody.innerHTML = data.map(row => 
        '<tr>' +
        headers.map(h => {
          let val = row[h];
          if (val === 'SI') val = '<span class="badge badge-success">SI</span>';
          if (val === 'NO') val = '<span class="badge badge-error">NO</span>';
          return '<td>' + val + '</td>';
        }).join('') +
        '</tr>'
      ).join('');
    }

    // ===== Ranking =====
    function renderRanking(data) {
      const rankingBody = document.getElementById('rankingBody');
      // ordenar por Habilidad Comercial: SI primero
      const sorted = [...data].sort((a,b) => (b['Habilidad Comercial'] === 'SI') - (a['Habilidad Comercial'] === 'SI'));
      rankingBody.innerHTML = sorted.map(r => 
        `<tr><td>${r.Ejecutivo}</td><td>${r['Habilidad Comercial']}</td></tr>`
      ).join('');
    }

    // ===== Charts =====
    function renderCharts(data) {
      const ctx1 = document.getElementById('chart1').getContext('2d');
      const ctx2 = document.getElementById('chart2').getContext('2d');
      
      // Habilidad Comercial
      const habilidadCount = { SI: 0, NO: 0 };
      data.forEach(d => { habilidadCount[d['Habilidad Comercial']] = (habilidadCount[d['Habilidad Comercial']]||0)+1; });
      
      new Chart(ctx1, {
        type: 'doughnut',
        data: {
          labels: ['SI','NO'],
          datasets: [{ data: [habilidadCount.SI, habilidadCount.NO], backgroundColor: ['#32b8c6','#ff5459'] }]
        },
        options: { responsive:true, plugins:{title:{display:true,text:'Habilidad Comercial'}} }
      });

      // Tipo de Llamada
      const tipoCount = {};
      data.forEach(d => { tipoCount[d['Tipo de Llamada']] = (tipoCount[d['Tipo de Llamada']]||0)+1; });
      new Chart(ctx2, {
        type: 'bar',
        data: {
          labels: Object.keys(tipoCount),
          datasets: [{ label:'Cantidad', data: Object.values(tipoCount), backgroundColor:'#21808d' }]
        },
        options:{ responsive:true, plugins:{title:{display:true,text:'Tipo de Llamada'}} }
      });
    }

    // ===== Fecha y hora =====
    function startDateTime() {
      const dateTimeEl = document.getElementById('dateTime');
      function update() {
        const now = new Date();
        dateTimeEl.textContent = now.toLocaleString('es-PE', {weekday:'long', year:'numeric', month:'long', day:'numeric', hour:'2-digit', minute:'2-digit', second:'2-digit'});
      }
      update();
      setInterval(update, 1000);
    }

    // ===== Buscar en tabla =====
    document.getElementById('searchInput').addEventListener('input', function(){
      const query = this.value.toLowerCase();
      const filtered = sampleData.filter(r => Object.values(r).some(v => String(v).toLowerCase().includes(query)));
      renderTable(filtered);
    });

    // ===== Botones de navegaci칩n =====
    document.getElementById('btnDashboard').addEventListener('click', () => {
      document.getElementById('tableSection').classList.remove('hidden');
      document.getElementById('rankingSection').classList.add('hidden');
    });
    document.getElementById('btnRanking').addEventListener('click', () => {
      document.getElementById('tableSection').classList.add('hidden');
      document.getElementById('rankingSection').classList.remove('hidden');
    });
    document.getElementById('btnGestionCalidad').addEventListener('click', () => {
      document.getElementById('tableSection').classList.remove('hidden');
      document.getElementById('rankingSection').classList.add('hidden');
    });

  </script>

</body>
</html>
